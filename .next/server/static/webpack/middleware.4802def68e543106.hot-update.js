"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.js":
/*!***********************!*\
  !*** ./middleware.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jose */ \"(middleware)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(middleware)/./node_modules/next/dist/esm/api/headers.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n\nconst JWT_SECRET = process.env.JWT_SECRET;\nconst ROLE_CLAIM = 'http://schemas.microsoft.com/ws/2008/06/identity/claims/role';\nconst VERIFIED_CLAIM = 'http://schemas.xmlsoap.org/ws/2009/09/identity/claims/actor';\nasync function verifyToken(token) {\n    try {\n        return await (0,jose__WEBPACK_IMPORTED_MODULE_3__.jwtVerify)(token, new TextEncoder().encode(JWT_SECRET));\n    } catch  {\n        return null;\n    }\n}\nfunction clearCookies(response, cookieNames) {\n    cookieNames.forEach((name)=>{\n        response.cookies.set(name, '', {\n            maxAge: 0,\n            path: '/',\n            httpOnly: true,\n            secure: true,\n            sameSite: 'Strict'\n        });\n    });\n}\nfunction applySecurityHeaders(response, nonce) {\n    const csp = `\n    default-src 'self';\n    script-src 'self' 'nonce-${nonce}';\n    style-src 'self' 'unsafe-inline';\n    img-src 'self' data: blob:;\n    font-src 'self';\n    connect-src 'self';\n    frame-ancestors 'none';\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    upgrade-insecure-requests;\n  `.replace(/\\s{2,}/g, ' ').trim();\n    response.headers.set('Content-Security-Policy', csp);\n    response.headers.set('X-Content-Type-Options', 'nosniff');\n    response.headers.set('X-Frame-Options', 'DENY');\n    response.headers.set('Strict-Transport-Security', 'max-age=63072000; includeSubDomains; preload');\n    response.headers.set('Referrer-Policy', 'strict-origin-when-cross-origin');\n    response.headers.set('X-XSS-Protection', '1; mode=block');\n}\nasync function middleware(req) {\n    const url = new URL(req.url);\n    const pathname = url.pathname;\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const tokenCookie = cookieStore.get('token');\n    const otpTokenCookie = cookieStore.get('otp_token');\n    const resetTokenCookie = cookieStore.get('reset');\n    const tokensPresent = [\n        tokenCookie,\n        otpTokenCookie,\n        resetTokenCookie\n    ].filter(Boolean);\n    const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    // Inject security headers\n    const nonce = await generateNonce();\n    applySecurityHeaders(response, nonce);\n    if (tokensPresent.length > 1) {\n        clearCookies(response, [\n            'token',\n            'otp_token',\n            'reset'\n        ]);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/un/login', req.url));\n    }\n    const isAuthPage = [\n        '/un/login',\n        '/un/register'\n    ].some((path)=>pathname.startsWith(path));\n    const isOtpPage = pathname.startsWith('/un/otpValidatePassword');\n    const isResetPage = pathname.startsWith('/un/resetPassword');\n    const isConfirmEmailPage = pathname.startsWith('/User/VerifyEmail');\n    const isProtectedPage = pathname.startsWith('/User') || pathname.startsWith('/Admin');\n    async function verifyOrClear(token) {\n        if (!token) return null;\n        const decoded = await verifyToken(token.value);\n        if (!decoded) {\n            clearCookies(response, [\n                'token',\n                'otp_token',\n                'reset'\n            ]);\n            return null;\n        }\n        return decoded;\n    }\n    if (isOtpPage) {\n        const decoded = await verifyOrClear(otpTokenCookie);\n        if (!decoded) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/un/login', req.url));\n        return response;\n    }\n    if (isResetPage) {\n        const decoded = await verifyOrClear(resetTokenCookie);\n        if (!decoded) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/un/login', req.url));\n        return response;\n    }\n    if (isAuthPage) {\n        clearCookies(response, [\n            'otp_token',\n            'reset'\n        ]);\n        if (tokenCookie) {\n            const decoded = await verifyOrClear(tokenCookie);\n            if (!decoded) return response;\n            const roles = decoded.payload[ROLE_CLAIM] || [];\n            const role = Array.isArray(roles) ? roles[0] : roles;\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(`/${role}/dashboard`, req.url));\n        }\n        return response;\n    }\n    if (isProtectedPage) {\n        const decoded = await verifyOrClear(tokenCookie);\n        if (!decoded) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/un/login', req.url));\n        const roles = decoded.payload[ROLE_CLAIM] || [];\n        const role = Array.isArray(roles) ? roles[0] : roles;\n        if (isConfirmEmailPage) {\n            const isVerified = decoded.payload[VERIFIED_CLAIM];\n            if (isVerified === 'True') {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(`/${role}/dashboard`, req.url));\n            }\n            return response;\n        }\n        if (pathname.startsWith('/Admin') && role !== 'Admin' || pathname.startsWith('/User') && role !== 'User') {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(`/${role}/dashboard`, req.url));\n        }\n        return response;\n    }\n    return response;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUMsRUFBRSxHQUFHQTtRQUUvQyxJQUFJTCxvQkFBb0I7WUFDdEIsTUFBTVUsYUFBYVAsUUFBUUcsT0FBTyxDQUFDbEQsZUFBZTtZQUNsRCxJQUFJc0QsZUFBZSxRQUFRO2dCQUN6QixPQUFPOUQscURBQVlBLENBQUM4QyxRQUFRLENBQUMsSUFBSWIsSUFBSSxDQUFDLENBQUMsRUFBRTBCLEtBQUssVUFBVSxDQUFDLEVBQUU1QixJQUFJQyxHQUFHO1lBQ3BFO1lBQ0EsT0FBT2xCO1FBQ1Q7UUFFQSxJQUNFLFNBQVVtQyxVQUFVLENBQUMsYUFBYVUsU0FBUyxXQUMxQ3pCLFNBQVNlLFVBQVUsQ0FBQyxZQUFZVSxTQUFTLFFBQzFDO1lBQ0EsT0FBTzNELHFEQUFZQSxDQUFDOEMsUUFBUSxDQUFDLElBQUliLElBQUksQ0FBQyxDQUFDLEVBQUUwQixLQUFLLFVBQVUsQ0FBQyxFQUFFNUIsSUFBSUMsR0FBRztRQUNwRTtRQUVBLE9BQU9sQjtJQUNUO0lBRUEsT0FBT0E7QUFDVCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxNb2hhbWFkXFxPbmVEcml2ZVxcRGVza3RvcFxcUnVoYW5fTmV4dCthc3BcXHJ1aGFuXFxtaWRkbGV3YXJlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgand0VmVyaWZ5IH0gZnJvbSAnam9zZSc7XHJcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnO1xyXG5pbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0byc7XHJcblxyXG5jb25zdCBKV1RfU0VDUkVUID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVDtcclxuY29uc3QgUk9MRV9DTEFJTSA9ICdodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL3JvbGUnO1xyXG5jb25zdCBWRVJJRklFRF9DTEFJTSA9ICdodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA5LzA5L2lkZW50aXR5L2NsYWltcy9hY3Rvcic7XHJcblxyXG5hc3luYyBmdW5jdGlvbiB2ZXJpZnlUb2tlbih0b2tlbikge1xyXG4gIHRyeSB7XHJcbiAgICByZXR1cm4gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoSldUX1NFQ1JFVCkpO1xyXG4gIH0gY2F0Y2gge1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjbGVhckNvb2tpZXMocmVzcG9uc2UsIGNvb2tpZU5hbWVzKSB7XHJcbiAgY29va2llTmFtZXMuZm9yRWFjaChuYW1lID0+IHtcclxuICAgIHJlc3BvbnNlLmNvb2tpZXMuc2V0KG5hbWUsICcnLCB7XHJcbiAgICAgIG1heEFnZTogMCxcclxuICAgICAgcGF0aDogJy8nLFxyXG4gICAgICBodHRwT25seTogdHJ1ZSxcclxuICAgICAgc2VjdXJlOiB0cnVlLFxyXG4gICAgICBzYW1lU2l0ZTogJ1N0cmljdCcsXHJcbiAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gYXBwbHlTZWN1cml0eUhlYWRlcnMocmVzcG9uc2UsIG5vbmNlKSB7XHJcbiAgY29uc3QgY3NwID0gYFxyXG4gICAgZGVmYXVsdC1zcmMgJ3NlbGYnO1xyXG4gICAgc2NyaXB0LXNyYyAnc2VsZicgJ25vbmNlLSR7bm9uY2V9JztcclxuICAgIHN0eWxlLXNyYyAnc2VsZicgJ3Vuc2FmZS1pbmxpbmUnO1xyXG4gICAgaW1nLXNyYyAnc2VsZicgZGF0YTogYmxvYjo7XHJcbiAgICBmb250LXNyYyAnc2VsZic7XHJcbiAgICBjb25uZWN0LXNyYyAnc2VsZic7XHJcbiAgICBmcmFtZS1hbmNlc3RvcnMgJ25vbmUnO1xyXG4gICAgb2JqZWN0LXNyYyAnbm9uZSc7XHJcbiAgICBiYXNlLXVyaSAnc2VsZic7XHJcbiAgICBmb3JtLWFjdGlvbiAnc2VsZic7XHJcbiAgICB1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzO1xyXG4gIGAucmVwbGFjZSgvXFxzezIsfS9nLCAnICcpLnRyaW0oKTtcclxuXHJcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0NvbnRlbnQtU2VjdXJpdHktUG9saWN5JywgY3NwKTtcclxuICByZXNwb25zZS5oZWFkZXJzLnNldCgnWC1Db250ZW50LVR5cGUtT3B0aW9ucycsICdub3NuaWZmJyk7XHJcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ1gtRnJhbWUtT3B0aW9ucycsICdERU5ZJyk7XHJcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ1N0cmljdC1UcmFuc3BvcnQtU2VjdXJpdHknLCAnbWF4LWFnZT02MzA3MjAwMDsgaW5jbHVkZVN1YkRvbWFpbnM7IHByZWxvYWQnKTtcclxuICByZXNwb25zZS5oZWFkZXJzLnNldCgnUmVmZXJyZXItUG9saWN5JywgJ3N0cmljdC1vcmlnaW4td2hlbi1jcm9zcy1vcmlnaW4nKTtcclxuICByZXNwb25zZS5oZWFkZXJzLnNldCgnWC1YU1MtUHJvdGVjdGlvbicsICcxOyBtb2RlPWJsb2NrJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcSkge1xyXG4gIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxLnVybCk7XHJcbiAgY29uc3QgcGF0aG5hbWUgPSB1cmwucGF0aG5hbWU7XHJcbiAgY29uc3QgY29va2llU3RvcmUgPSBjb29raWVzKCk7XHJcbiAgY29uc3QgdG9rZW5Db29raWUgPSBjb29raWVTdG9yZS5nZXQoJ3Rva2VuJyk7XHJcbiAgY29uc3Qgb3RwVG9rZW5Db29raWUgPSBjb29raWVTdG9yZS5nZXQoJ290cF90b2tlbicpO1xyXG4gIGNvbnN0IHJlc2V0VG9rZW5Db29raWUgPSBjb29raWVTdG9yZS5nZXQoJ3Jlc2V0Jyk7XHJcblxyXG4gIGNvbnN0IHRva2Vuc1ByZXNlbnQgPSBbdG9rZW5Db29raWUsIG90cFRva2VuQ29va2llLCByZXNldFRva2VuQ29va2llXS5maWx0ZXIoQm9vbGVhbik7XHJcbiAgY29uc3QgcmVzcG9uc2UgPSBOZXh0UmVzcG9uc2UubmV4dCgpO1xyXG5cclxuICAvLyBJbmplY3Qgc2VjdXJpdHkgaGVhZGVyc1xyXG4gIGNvbnN0IG5vbmNlID0gYXdhaXQgZ2VuZXJhdGVOb25jZSgpO1xyXG4gIGFwcGx5U2VjdXJpdHlIZWFkZXJzKHJlc3BvbnNlLCBub25jZSk7XHJcblxyXG4gIGlmICh0b2tlbnNQcmVzZW50Lmxlbmd0aCA+IDEpIHtcclxuICAgIGNsZWFyQ29va2llcyhyZXNwb25zZSwgWyd0b2tlbicsICdvdHBfdG9rZW4nLCAncmVzZXQnXSk7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy91bi9sb2dpbicsIHJlcS51cmwpKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGlzQXV0aFBhZ2UgPSBbJy91bi9sb2dpbicsICcvdW4vcmVnaXN0ZXInXS5zb21lKHBhdGggPT4gcGF0aG5hbWUuc3RhcnRzV2l0aChwYXRoKSk7XHJcbiAgY29uc3QgaXNPdHBQYWdlID0gcGF0aG5hbWUuc3RhcnRzV2l0aCgnL3VuL290cFZhbGlkYXRlUGFzc3dvcmQnKTtcclxuICBjb25zdCBpc1Jlc2V0UGFnZSA9IHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy91bi9yZXNldFBhc3N3b3JkJyk7XHJcbiAgY29uc3QgaXNDb25maXJtRW1haWxQYWdlID0gcGF0aG5hbWUuc3RhcnRzV2l0aCgnL1VzZXIvVmVyaWZ5RW1haWwnKTtcclxuICBjb25zdCBpc1Byb3RlY3RlZFBhZ2UgPSBwYXRobmFtZS5zdGFydHNXaXRoKCcvVXNlcicpIHx8IHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9BZG1pbicpO1xyXG5cclxuICBhc3luYyBmdW5jdGlvbiB2ZXJpZnlPckNsZWFyKHRva2VuKSB7XHJcbiAgICBpZiAoIXRva2VuKSByZXR1cm4gbnVsbDtcclxuICAgIGNvbnN0IGRlY29kZWQgPSBhd2FpdCB2ZXJpZnlUb2tlbih0b2tlbi52YWx1ZSk7XHJcbiAgICBpZiAoIWRlY29kZWQpIHtcclxuICAgICAgY2xlYXJDb29raWVzKHJlc3BvbnNlLCBbJ3Rva2VuJywgJ290cF90b2tlbicsICdyZXNldCddKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGVjb2RlZDtcclxuICB9XHJcblxyXG4gIGlmIChpc090cFBhZ2UpIHtcclxuICAgIGNvbnN0IGRlY29kZWQgPSBhd2FpdCB2ZXJpZnlPckNsZWFyKG90cFRva2VuQ29va2llKTtcclxuICAgIGlmICghZGVjb2RlZCkgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvdW4vbG9naW4nLCByZXEudXJsKSk7XHJcbiAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgfVxyXG5cclxuICBpZiAoaXNSZXNldFBhZ2UpIHtcclxuICAgIGNvbnN0IGRlY29kZWQgPSBhd2FpdCB2ZXJpZnlPckNsZWFyKHJlc2V0VG9rZW5Db29raWUpO1xyXG4gICAgaWYgKCFkZWNvZGVkKSByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy91bi9sb2dpbicsIHJlcS51cmwpKTtcclxuICAgIHJldHVybiByZXNwb25zZTtcclxuICB9XHJcblxyXG4gIGlmIChpc0F1dGhQYWdlKSB7XHJcbiAgICBjbGVhckNvb2tpZXMocmVzcG9uc2UsIFsnb3RwX3Rva2VuJywgJ3Jlc2V0J10pO1xyXG4gICAgaWYgKHRva2VuQ29va2llKSB7XHJcbiAgICAgIGNvbnN0IGRlY29kZWQgPSBhd2FpdCB2ZXJpZnlPckNsZWFyKHRva2VuQ29va2llKTtcclxuICAgICAgaWYgKCFkZWNvZGVkKSByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICAgIGNvbnN0IHJvbGVzID0gZGVjb2RlZC5wYXlsb2FkW1JPTEVfQ0xBSU1dIHx8IFtdO1xyXG4gICAgICBjb25zdCByb2xlID0gQXJyYXkuaXNBcnJheShyb2xlcykgPyByb2xlc1swXSA6IHJvbGVzO1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoYC8ke3JvbGV9L2Rhc2hib2FyZGAsIHJlcS51cmwpKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXNwb25zZTtcclxuICB9XHJcblxyXG4gIGlmIChpc1Byb3RlY3RlZFBhZ2UpIHtcclxuICAgIGNvbnN0IGRlY29kZWQgPSBhd2FpdCB2ZXJpZnlPckNsZWFyKHRva2VuQ29va2llKTtcclxuICAgIGlmICghZGVjb2RlZCkgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvdW4vbG9naW4nLCByZXEudXJsKSk7XHJcblxyXG4gICAgY29uc3Qgcm9sZXMgPSBkZWNvZGVkLnBheWxvYWRbUk9MRV9DTEFJTV0gfHwgW107XHJcbiAgICBjb25zdCByb2xlID0gQXJyYXkuaXNBcnJheShyb2xlcykgPyByb2xlc1swXSA6IHJvbGVzO1xyXG5cclxuICAgIGlmIChpc0NvbmZpcm1FbWFpbFBhZ2UpIHtcclxuICAgICAgY29uc3QgaXNWZXJpZmllZCA9IGRlY29kZWQucGF5bG9hZFtWRVJJRklFRF9DTEFJTV07XHJcbiAgICAgIGlmIChpc1ZlcmlmaWVkID09PSAnVHJ1ZScpIHtcclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoYC8ke3JvbGV9L2Rhc2hib2FyZGAsIHJlcS51cmwpKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKFxyXG4gICAgICAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL0FkbWluJykgJiYgcm9sZSAhPT0gJ0FkbWluJykgfHxcclxuICAgICAgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9Vc2VyJykgJiYgcm9sZSAhPT0gJ1VzZXInKVxyXG4gICAgKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTChgLyR7cm9sZX0vZGFzaGJvYXJkYCwgcmVxLnVybCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXNwb25zZTtcclxuICB9XHJcblxyXG4gIHJldHVybiByZXNwb25zZTtcclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiand0VmVyaWZ5IiwiY29va2llcyIsImNyeXB0byIsIkpXVF9TRUNSRVQiLCJwcm9jZXNzIiwiZW52IiwiUk9MRV9DTEFJTSIsIlZFUklGSUVEX0NMQUlNIiwidmVyaWZ5VG9rZW4iLCJ0b2tlbiIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwiY2xlYXJDb29raWVzIiwicmVzcG9uc2UiLCJjb29raWVOYW1lcyIsImZvckVhY2giLCJuYW1lIiwic2V0IiwibWF4QWdlIiwicGF0aCIsImh0dHBPbmx5Iiwic2VjdXJlIiwic2FtZVNpdGUiLCJhcHBseVNlY3VyaXR5SGVhZGVycyIsIm5vbmNlIiwiY3NwIiwicmVwbGFjZSIsInRyaW0iLCJoZWFkZXJzIiwibWlkZGxld2FyZSIsInJlcSIsInVybCIsIlVSTCIsInBhdGhuYW1lIiwiY29va2llU3RvcmUiLCJ0b2tlbkNvb2tpZSIsImdldCIsIm90cFRva2VuQ29va2llIiwicmVzZXRUb2tlbkNvb2tpZSIsInRva2Vuc1ByZXNlbnQiLCJmaWx0ZXIiLCJCb29sZWFuIiwibmV4dCIsImdlbmVyYXRlTm9uY2UiLCJsZW5ndGgiLCJyZWRpcmVjdCIsImlzQXV0aFBhZ2UiLCJzb21lIiwic3RhcnRzV2l0aCIsImlzT3RwUGFnZSIsImlzUmVzZXRQYWdlIiwiaXNDb25maXJtRW1haWxQYWdlIiwiaXNQcm90ZWN0ZWRQYWdlIiwidmVyaWZ5T3JDbGVhciIsImRlY29kZWQiLCJ2YWx1ZSIsInJvbGVzIiwicGF5bG9hZCIsInJvbGUiLCJBcnJheSIsImlzQXJyYXkiLCJpc1ZlcmlmaWVkIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./middleware.js\n");

/***/ })

});