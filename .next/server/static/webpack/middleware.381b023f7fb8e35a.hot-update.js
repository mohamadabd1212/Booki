"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.js":
/*!***********************!*\
  !*** ./middleware.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jose */ \"(middleware)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(middleware)/./node_modules/next/dist/esm/api/headers.js\");\n/* harmony import */ var process__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! process */ \"(middleware)/./node_modules/next/dist/build/polyfills/process.js\");\n/* harmony import */ var process__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(process__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n\nconst JWT_SECRET = process.env.JWT_SECRET;\nconst ROLE_CLAIM = 'http://schemas.microsoft.com/ws/2008/06/identity/claims/role';\nconst VERIFIED_CLAIM = 'http://schemas.xmlsoap.org/ws/2009/09/identity/claims/actor';\nasync function verifyToken(token) {\n    try {\n        return await (0,jose__WEBPACK_IMPORTED_MODULE_3__.jwtVerify)(token, new TextEncoder().encode(JWT_SECRET));\n    } catch  {\n        return null;\n    }\n}\nfunction clearCookies(response, cookieNames) {\n    cookieNames.forEach((name)=>response.cookies.set(name, '', {\n            maxAge: 0,\n            path: '/'\n        }));\n}\nasync function middleware(req) {\n    const pathname = req.nextUrl.pathname;\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const referer = req.headers.get('referer');\n    const tokenCookie = cookieStore.get('token');\n    const otpTokenCookie = cookieStore.get('otp_token');\n    const resetTokenCookie = cookieStore.get('reset');\n    if (referer == null || !referer.startsWith(process.env.ALLOWEDORIGINS)) return (0,next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse)(\"blocked\", {\n        status: 500\n    });\n    const tokensPresent = [\n        tokenCookie,\n        otpTokenCookie,\n        resetTokenCookie\n    ].filter(Boolean);\n    const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    if (tokensPresent.length > 1) {\n        clearCookies(response, [\n            'token',\n            'otp_token',\n            'reset'\n        ]);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/un/login', req.url));\n    }\n    const isAuthPage = [\n        '/un/login',\n        '/un/register'\n    ].some((path)=>pathname.startsWith(path));\n    const isOtpPage = pathname.startsWith('/un/otpValidatePassword');\n    const isResetPage = pathname.startsWith('/un/resetPassword');\n    const isConfirmEmailPage = pathname.startsWith('/User/VerifyEmail');\n    const isProtectedPage = pathname.startsWith('/User') || pathname.startsWith('/Admin');\n    async function verifyOrClear(tokenCookie) {\n        if (!tokenCookie) return null;\n        const decoded = await verifyToken(tokenCookie.value);\n        if (!decoded) {\n            clearCookies(response, [\n                'token',\n                'otp_token',\n                'reset'\n            ]);\n            return null;\n        }\n        return decoded;\n    }\n    // OTP page requires valid otp_token\n    if (isOtpPage) {\n        const decoded = await verifyOrClear(otpTokenCookie);\n        if (!decoded) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/un/login', req.url));\n        return response;\n    }\n    // Reset page requires valid reset token\n    if (isResetPage) {\n        const decoded = await verifyOrClear(resetTokenCookie);\n        if (!decoded) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/un/login', req.url));\n        return response;\n    }\n    // Auth pages\n    if (isAuthPage) {\n        clearCookies(response, [\n            'otp_token',\n            'reset'\n        ]);\n        if (tokenCookie) {\n            const decoded = await verifyOrClear(tokenCookie);\n            if (!decoded) return response; // âœ… Just stay on login page after clearing\n            const roles = decoded.payload[ROLE_CLAIM] || [];\n            const role = Array.isArray(roles) ? roles[0] : roles;\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(`/${role}/dashboard`, req.url));\n        }\n        return response;\n    }\n    // Protected pages\n    if (isProtectedPage) {\n        const decoded = await verifyOrClear(tokenCookie);\n        if (!decoded) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/un/login', req.url));\n        const roles = decoded.payload[ROLE_CLAIM] || [];\n        const role = Array.isArray(roles) ? roles[0] : roles;\n        if (isConfirmEmailPage) {\n            const isVerified = decoded.payload[VERIFIED_CLAIM];\n            if (isVerified === 'True') {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(`/${role}/dashboard`, req.url));\n            }\n            return response;\n        }\n        // Role-based restriction\n        if (pathname.startsWith('/Admin') && role !== 'Admin' || pathname.startsWith('/User') && role !== 'User') {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(`/${role}/dashboard`, req.url));\n        }\n        return response;\n    }\n    return response;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVMsV0FDMUMvQixTQUFTUyxVQUFVLENBQUMsWUFBWXNCLFNBQVMsUUFDMUM7WUFDQSxPQUFPdEQscURBQVlBLENBQUN3QyxRQUFRLENBQUMsSUFBSUMsSUFBSSxDQUFDLENBQUMsRUFBRWEsS0FBSyxVQUFVLENBQUMsRUFBRWhDLElBQUlvQixHQUFHO1FBQ3BFO1FBRUEsT0FBTzVCO0lBQ1Q7SUFFQSxPQUFPQTtBQUNUIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXE1vaGFtYWRcXE9uZURyaXZlXFxEZXNrdG9wXFxSdWhhbl9OZXh0K2FzcFxccnVoYW5cXG1pZGRsZXdhcmUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBqd3RWZXJpZnkgfSBmcm9tICdqb3NlJztcclxuaW1wb3J0IHsgY29va2llcyB9IGZyb20gJ25leHQvaGVhZGVycyc7XHJcbmltcG9ydCB7IHJlZiB9IGZyb20gJ3Byb2Nlc3MnO1xyXG5cclxuY29uc3QgSldUX1NFQ1JFVCA9IHByb2Nlc3MuZW52LkpXVF9TRUNSRVQ7XHJcbmNvbnN0IFJPTEVfQ0xBSU0gPSAnaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93cy8yMDA4LzA2L2lkZW50aXR5L2NsYWltcy9yb2xlJztcclxuY29uc3QgVkVSSUZJRURfQ0xBSU0gPSAnaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwOS8wOS9pZGVudGl0eS9jbGFpbXMvYWN0b3InO1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gdmVyaWZ5VG9rZW4odG9rZW4pIHtcclxuICB0cnkge1xyXG4gICAgcmV0dXJuIGF3YWl0IGp3dFZlcmlmeSh0b2tlbiwgbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKEpXVF9TRUNSRVQpKTtcclxuICB9IGNhdGNoIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2xlYXJDb29raWVzKHJlc3BvbnNlLCBjb29raWVOYW1lcykge1xyXG4gIGNvb2tpZU5hbWVzLmZvckVhY2gobmFtZSA9PlxyXG4gICAgcmVzcG9uc2UuY29va2llcy5zZXQobmFtZSwgJycsIHtcclxuICAgICAgbWF4QWdlOiAwLFxyXG4gICAgICBwYXRoOiAnLycsXHJcbiAgICB9KVxyXG4gICk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcSkge1xyXG4gIGNvbnN0IHBhdGhuYW1lID0gcmVxLm5leHRVcmwucGF0aG5hbWU7XHJcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKCk7XHJcbiAgY29uc3QgcmVmZXJlciA9IHJlcS5oZWFkZXJzLmdldCgncmVmZXJlcicpO1xyXG4gIGNvbnN0IHRva2VuQ29va2llID0gY29va2llU3RvcmUuZ2V0KCd0b2tlbicpO1xyXG4gIGNvbnN0IG90cFRva2VuQ29va2llID0gY29va2llU3RvcmUuZ2V0KCdvdHBfdG9rZW4nKTtcclxuICBjb25zdCByZXNldFRva2VuQ29va2llID0gY29va2llU3RvcmUuZ2V0KCdyZXNldCcpO1xyXG4gIGlmKHJlZmVyZXIgPT0gbnVsbCB8fCAhcmVmZXJlci5zdGFydHNXaXRoKHByb2Nlc3MuZW52LkFMTE9XRURPUklHSU5TKSlcclxucmV0dXJuIE5leHRSZXNwb25zZShcImJsb2NrZWRcIix7c3RhdHVzOjUwMH0pXHJcblxyXG4gIGNvbnN0IHRva2Vuc1ByZXNlbnQgPSBbdG9rZW5Db29raWUsIG90cFRva2VuQ29va2llLCByZXNldFRva2VuQ29va2llXS5maWx0ZXIoQm9vbGVhbik7XHJcbiAgY29uc3QgcmVzcG9uc2UgPSBOZXh0UmVzcG9uc2UubmV4dCgpO1xyXG5cclxuICBpZiAodG9rZW5zUHJlc2VudC5sZW5ndGggPiAxKSB7XHJcbiAgICBjbGVhckNvb2tpZXMocmVzcG9uc2UsIFsndG9rZW4nLCAnb3RwX3Rva2VuJywgJ3Jlc2V0J10pO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvdW4vbG9naW4nLCByZXEudXJsKSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBpc0F1dGhQYWdlID0gWycvdW4vbG9naW4nLCAnL3VuL3JlZ2lzdGVyJ10uc29tZShwYXRoID0+IHBhdGhuYW1lLnN0YXJ0c1dpdGgocGF0aCkpO1xyXG4gIGNvbnN0IGlzT3RwUGFnZSA9IHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy91bi9vdHBWYWxpZGF0ZVBhc3N3b3JkJyk7XHJcbiAgY29uc3QgaXNSZXNldFBhZ2UgPSBwYXRobmFtZS5zdGFydHNXaXRoKCcvdW4vcmVzZXRQYXNzd29yZCcpO1xyXG4gIGNvbnN0IGlzQ29uZmlybUVtYWlsUGFnZSA9IHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9Vc2VyL1ZlcmlmeUVtYWlsJyk7XHJcbiAgY29uc3QgaXNQcm90ZWN0ZWRQYWdlID0gcGF0aG5hbWUuc3RhcnRzV2l0aCgnL1VzZXInKSB8fCBwYXRobmFtZS5zdGFydHNXaXRoKCcvQWRtaW4nKTtcclxuXHJcbiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5T3JDbGVhcih0b2tlbkNvb2tpZSkge1xyXG4gICAgaWYgKCF0b2tlbkNvb2tpZSkgcmV0dXJuIG51bGw7XHJcbiAgICBjb25zdCBkZWNvZGVkID0gYXdhaXQgdmVyaWZ5VG9rZW4odG9rZW5Db29raWUudmFsdWUpO1xyXG4gICAgaWYgKCFkZWNvZGVkKSB7XHJcbiAgICAgIGNsZWFyQ29va2llcyhyZXNwb25zZSwgWyd0b2tlbicsICdvdHBfdG9rZW4nLCAncmVzZXQnXSk7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRlY29kZWQ7XHJcbiAgfVxyXG5cclxuICAvLyBPVFAgcGFnZSByZXF1aXJlcyB2YWxpZCBvdHBfdG9rZW5cclxuICBpZiAoaXNPdHBQYWdlKSB7XHJcbiAgICBjb25zdCBkZWNvZGVkID0gYXdhaXQgdmVyaWZ5T3JDbGVhcihvdHBUb2tlbkNvb2tpZSk7XHJcbiAgICBpZiAoIWRlY29kZWQpIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL3VuL2xvZ2luJywgcmVxLnVybCkpO1xyXG4gICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gIH1cclxuXHJcbiAgLy8gUmVzZXQgcGFnZSByZXF1aXJlcyB2YWxpZCByZXNldCB0b2tlblxyXG4gIGlmIChpc1Jlc2V0UGFnZSkge1xyXG4gICAgY29uc3QgZGVjb2RlZCA9IGF3YWl0IHZlcmlmeU9yQ2xlYXIocmVzZXRUb2tlbkNvb2tpZSk7XHJcbiAgICBpZiAoIWRlY29kZWQpIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL3VuL2xvZ2luJywgcmVxLnVybCkpO1xyXG4gICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gIH1cclxuXHJcbiAgLy8gQXV0aCBwYWdlc1xyXG4gIGlmIChpc0F1dGhQYWdlKSB7XHJcbiAgICBjbGVhckNvb2tpZXMocmVzcG9uc2UsIFsnb3RwX3Rva2VuJywgJ3Jlc2V0J10pO1xyXG5cclxuICAgIGlmICh0b2tlbkNvb2tpZSkge1xyXG4gICAgICBjb25zdCBkZWNvZGVkID0gYXdhaXQgdmVyaWZ5T3JDbGVhcih0b2tlbkNvb2tpZSk7XHJcbiAgICAgIGlmICghZGVjb2RlZCkgcmV0dXJuIHJlc3BvbnNlOyAvLyDinIUgSnVzdCBzdGF5IG9uIGxvZ2luIHBhZ2UgYWZ0ZXIgY2xlYXJpbmdcclxuXHJcbiAgICAgIGNvbnN0IHJvbGVzID0gZGVjb2RlZC5wYXlsb2FkW1JPTEVfQ0xBSU1dIHx8IFtdO1xyXG4gICAgICBjb25zdCByb2xlID0gQXJyYXkuaXNBcnJheShyb2xlcykgPyByb2xlc1swXSA6IHJvbGVzO1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoYC8ke3JvbGV9L2Rhc2hib2FyZGAsIHJlcS51cmwpKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXNwb25zZTtcclxuICB9XHJcblxyXG4gIC8vIFByb3RlY3RlZCBwYWdlc1xyXG4gIGlmIChpc1Byb3RlY3RlZFBhZ2UpIHtcclxuICAgIGNvbnN0IGRlY29kZWQgPSBhd2FpdCB2ZXJpZnlPckNsZWFyKHRva2VuQ29va2llKTtcclxuICAgIGlmICghZGVjb2RlZCkgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvdW4vbG9naW4nLCByZXEudXJsKSk7XHJcblxyXG4gICAgY29uc3Qgcm9sZXMgPSBkZWNvZGVkLnBheWxvYWRbUk9MRV9DTEFJTV0gfHwgW107XHJcbiAgICBjb25zdCByb2xlID0gQXJyYXkuaXNBcnJheShyb2xlcykgPyByb2xlc1swXSA6IHJvbGVzO1xyXG5cclxuICAgIGlmIChpc0NvbmZpcm1FbWFpbFBhZ2UpIHtcclxuICAgICAgY29uc3QgaXNWZXJpZmllZCA9IGRlY29kZWQucGF5bG9hZFtWRVJJRklFRF9DTEFJTV07XHJcbiAgICAgIGlmIChpc1ZlcmlmaWVkID09PSAnVHJ1ZScpIHtcclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoYC8ke3JvbGV9L2Rhc2hib2FyZGAsIHJlcS51cmwpKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUm9sZS1iYXNlZCByZXN0cmljdGlvblxyXG4gICAgaWYgKFxyXG4gICAgICAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL0FkbWluJykgJiYgcm9sZSAhPT0gJ0FkbWluJykgfHxcclxuICAgICAgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9Vc2VyJykgJiYgcm9sZSAhPT0gJ1VzZXInKVxyXG4gICAgKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTChgLyR7cm9sZX0vZGFzaGJvYXJkYCwgcmVxLnVybCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXNwb25zZTtcclxuICB9XHJcblxyXG4gIHJldHVybiByZXNwb25zZTtcclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiand0VmVyaWZ5IiwiY29va2llcyIsInJlZiIsIkpXVF9TRUNSRVQiLCJwcm9jZXNzIiwiZW52IiwiUk9MRV9DTEFJTSIsIlZFUklGSUVEX0NMQUlNIiwidmVyaWZ5VG9rZW4iLCJ0b2tlbiIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwiY2xlYXJDb29raWVzIiwicmVzcG9uc2UiLCJjb29raWVOYW1lcyIsImZvckVhY2giLCJuYW1lIiwic2V0IiwibWF4QWdlIiwicGF0aCIsIm1pZGRsZXdhcmUiLCJyZXEiLCJwYXRobmFtZSIsIm5leHRVcmwiLCJjb29raWVTdG9yZSIsInJlZmVyZXIiLCJoZWFkZXJzIiwiZ2V0IiwidG9rZW5Db29raWUiLCJvdHBUb2tlbkNvb2tpZSIsInJlc2V0VG9rZW5Db29raWUiLCJzdGFydHNXaXRoIiwiQUxMT1dFRE9SSUdJTlMiLCJzdGF0dXMiLCJ0b2tlbnNQcmVzZW50IiwiZmlsdGVyIiwiQm9vbGVhbiIsIm5leHQiLCJsZW5ndGgiLCJyZWRpcmVjdCIsIlVSTCIsInVybCIsImlzQXV0aFBhZ2UiLCJzb21lIiwiaXNPdHBQYWdlIiwiaXNSZXNldFBhZ2UiLCJpc0NvbmZpcm1FbWFpbFBhZ2UiLCJpc1Byb3RlY3RlZFBhZ2UiLCJ2ZXJpZnlPckNsZWFyIiwiZGVjb2RlZCIsInZhbHVlIiwicm9sZXMiLCJwYXlsb2FkIiwicm9sZSIsIkFycmF5IiwiaXNBcnJheSIsImlzVmVyaWZpZWQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./middleware.js\n");

/***/ })

});